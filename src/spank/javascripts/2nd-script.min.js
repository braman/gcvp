function _init(e){console.log("head_---------------------------------------");jQuery("head").empty();document.title="Второй монитор – CloudQueue";_data=e.group;var t=new Array;var n=true;$("#ad").empty();$("#ok_button").fadeOut();setTimeout(function(){if(sessionStorage.getItem("step")=="ticket"){myTicket(sessionStorage.getItem("tokenId"),sessionStorage.getItem("code"))}else if(sessionStorage.getItem("step")=="smile"){_lang=sessionStorage.getItem("lang");mySmile()}else if(sessionStorage.getItem("step")=="video"){myVideo()}},1e3);console.log(e)}function _onMessage(e){console.log("_onMessage:"+e);var t={};try{t=JSON.parse(e)}catch(n){console.warn("MntrUnt got non-JSON message:"+e)}if(t.smile){_lang=t.lang;console.log(t);mySmile();sessionStorage.setItem("step","smile");sessionStorage.setItem("lang",t.lang)}if(t.back){console.log("**** Back!!!!");console.log(t);second_number_1.hide();second_step_1.fadeOut();second_step_6.fadeOut();second_step_5.fadeOut();second_step_4.fadeOut();second_step_3.fadeOut();second_footer.fadeOut();$("#ok_button").fadeOut();sessionStorage.setItem("step","back")}if(t.refresh){console.log("**** REFRESH!!!!");second_number_1.empty()}if(t.refreshSmile){console.log("**** REFRESH SMILE!!!!")}if(t.video){myVideo();sessionStorage.setItem("step","video")}if(t.advertisement){console.log("**** ADVERTISEMENT!!!!");toAnketa();Qnumber=0}if(t.numbers){console.log("Numbers!!!!!!!!!!!");console.log(t.content);console.log(t.sender);_sender=t.sender;if(t.content!=null)toNumbers(t.content)}if(t.ticket){myTicket(t.ticket.tokenId,t.ticket.code);sessionStorage.setItem("step","ticket");sessionStorage.setItem("tokenId",t.ticket.tokenId);sessionStorage.setItem("code",t.ticket.code)}}function mySmile(){console.log("**** SMILE!!!!");_smile=true;$("#ad").empty();if(_lang=="KK")_kk_ru=_kk;else if(_lang=="RU")_kk_ru=_ru;else if(_lang=="EN")_kk_ru=_ru;if(_kk_ru!=null||_kk_ru!=""){jQuery("#very_good").text(_kk_ru.very_good);jQuery("#good").text(_kk_ru.good);jQuery("#normal").text(_kk_ru.normal);jQuery("#bad").text(_kk_ru.bad);jQuery("#very_bad").text(_kk_ru.very_bad);jQuery("#opinion").text(_kk_ru.opinion);jQuery("#anketa").text(_kk_ru.anketa);jQuery("#thanks_for_time").text(_kk_ru.thanks_for_time);jQuery("#thanks").text(_kk_ru.thanks)}second_number_1.empty();second_step_4.fadeOut();second_step_2.fadeOut();$("#ok_button").fadeOut();$(".second-step-7").fadeOut();second_step_3.add(second_footer).fadeIn()}function myVideo(){console.log("**** video !!!!");second_step_1.fadeOut();$("#ok_button").fadeOut();$(".second-step-7").fadeOut();$("#ad").html("<img src='images/logo/gcvp.jpg' style='width:100%'>");console.log("myVideo");second_step_2.add(second_footer).fadeIn();console.log("myVideoFinished")}function myTicket(e,t){console.log("**** TICKET!!!!");$("#ad").empty();e=e;second_number_1.text(t);second_number_1.show();second_step_1.fadeIn();second_step_6.fadeOut();second_step_5.fadeOut();second_step_4.fadeOut();second_step_3.fadeOut();second_footer.fadeOut()}function bot(){setInterval(function(){if(_smile){_smile=false;var e=parseInt(Math.random()*100);if(e>60){smile(5);console.log("good")}else if(e<30){smile(3);console.log("norm")}else{smile(2);console.log("bad")}}},2e3)}function toAnketa(e){console.log(Qnumber);console.log(_data.questions.length);if(e){Qnumber++}if(Qnumber>=_data.questions.length){toAnketaThanks();var t={action:"user_anketa",answer:e};XmppClient.send("queue",JSON.stringify(t))}else{if(Qnumber>0){var t={action:"user_anketa",answer:e};XmppClient.send("queue",JSON.stringify(t))}$("#anketa").empty();$("#ad").empty();$("#anketa").append($("<h5 class='question'>"+_data.questions[Qnumber].question+"</h5>"));$(_data.questions[Qnumber].answersName).each(function(e){if(_data.questions[Qnumber].answersName[e].Aname!="")$("#anketa").append($("<a class='feedback-link answer' onclick=\"toAnketa('"+_data.questions[Qnumber].answersId[e].AId+"');\">"+_data.questions[Qnumber].answersName[e].Aname+"</a>"))});second_step_1.fadeOut();second_step_2.fadeOut();second_step_3.fadeOut();$(".second-step-7").fadeOut();$("#ok_button").fadeOut();second_step_4.fadeIn()}}function toNumbers(e){global_content=e;console.log("########################################################");$("#numberUl").empty();$(e.number).each(function(t){console.log("*******************************************************");$("#numberUl").append("<li style='display: block;'><a style='padding-bottom: 0px; padding-top: 0px;' id='"+e.number[t].substring(1,12)+"' class='kiosk-link block' onclick=\" toggleNumber('"+e.number[t]+"')\">"+"<span>"+e.number[t]+"</span></a></li>")});second_step_1.fadeOut();second_step_2.fadeOut();second_step_3.fadeOut();second_step_4.fadeOut();second_step_5.fadeOut();second_step_6.fadeOut();$(".second-step-7").fadeIn();$("#ok_button").fadeIn()}function toggleNumber(e){kiosk_services=$("#kiosk-services a");IDNumber=$("#"+e.substring(1,12));var t=IDNumber;if(!t.hasClass("active")){t.addClass("active");$(global_content.number).each(function(t){if(global_content.number[t]!=e){$("#"+global_content.number[t].substring(1,12)).removeClass("active")}})}else t.removeClass("active");return false}function send_number(){$(global_content.number).each(function(e){if($("#"+global_content.number[e].substring(1,12)).hasClass("active")){var t={action:"send_number",number:global_content.number[e],receiver:_sender};XmppClient.send("queue",JSON.stringify(t))}})}function toAnketaThanks(){second_step_3.fadeOut();second_step_4.fadeOut();$(".second-step-7").fadeOut();$("#ok_button").fadeOut();second_step_6.fadeIn();setTimeout(function(){toVideo()},1e4)}function toVideo(){second_step_4.fadeOut();second_step_6.fadeOut();$(".second-step-7").fadeOut();$("#ok_button").fadeOut();$("#ad").html("<img src='images/logo/gcvp.jpg' style='width:100%'>");second_step_2.add(second_footer).fadeIn()}function refresh(){second_number_1.empty()}function _onStatus(e){if(e=="CONNECTED"||e=="ATTACHED"){onConnect()}if(e=="DISCONNECTED"){jQuery(".panel").fadeOut("slow")}}function smile(e){second_step_3.fadeOut();$("#ok_button").fadeOut();$(".second-step-7").fadeOut();second_step_5.fadeIn();var t={action:"ticket_smile",token:tokenId,condition:e};XmppClient.send("queue",JSON.stringify(t))}var second_step_1=$(".second-step-1"),second_number_1=$(".second-number"),second_step_2=$(".second-step-2"),second_step_3=$(".second-step-3"),second_step_4=$(".second-step-4"),second_step_5=$(".second-step-5"),second_step_6=$(".second-step-6"),second_footer=$(".second-footer");var remote_second={step1:function(){second_step_2.add(second_step_3).add(second_step_4).add(second_step_5).add(second_step_6).add(second_footer).fadeOut().promise().done(function(){second_step_1.fadeIn()})},step2:function(){second_step_1.add(second_step_3).add(second_step_4).add(second_step_5).add(second_step_6).fadeOut().promise().done(function(){second_step_2.add(second_footer).fadeIn()})},step3:function(){second_step_1.add(second_step_2).add(second_step_4).add(second_step_5).add(second_step_6).fadeOut().promise().done(function(){second_step_3.add(second_footer).fadeIn()})},step4:function(){second_step_1.add(second_step_2).add(second_step_3).add(second_step_5).add(second_step_6).add(second_footer).fadeOut().promise().done(function(){second_step_4.fadeIn()})},step5:function(){second_step_1.add(second_step_2).add(second_step_3).add(second_step_4).fadeOut().promise().done(function(){second_step_5.add(second_footer).fadeIn()})},step6:function(){second_step_1.add(second_step_2).add(second_step_3).add(second_step_4).fadeOut().promise().done(function(){second_step_6.add(second_footer).fadeIn()})}};var _kk={very_good:"Өте жақсы",good:"Жақсы",normal:"Нашар емес",bad:"Нашар",very_bad:"Өте нашар",anketa:"Анкета",thanks_for_time:"Уақытыңызға рахмет!",thanks:"Рахмет!",opinion:"Қызмет атқарудың деңгейі туралы Сіздің пікіріңіз"};var _ru={very_good:"Супер!",good:"Отлично",normal:"Хорошо",bad:"Не очень",very_bad:"Плохо",anketa:"Анкета",thanks_for_time:"Спасибо за ваше время!",thanks:"Спасибо!",opinion:"Ваше мнение об уровне услуг"};var _kk_ru;var _lang="";var iinFake;var _sender="";var kkButton;var ruButton;var tokenId;var _data=null;var Qnumber=0;var _smile=false;var global_content="";var aname=""