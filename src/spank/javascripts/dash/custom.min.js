function runTicket(e,t,n,r){if(leftTicket.length<4){for(var i=leftTicket.length-1;i>=0;i--){leftTicket[i+1]=leftTicket[i];leftWindow[i+1]=leftWindow[i];leftId[i+1]=leftId[i];leftColor[i+1]=leftColor[i]}leftTicket[0]=e;leftWindow[0]=t;leftId[0]=r;leftColor[0]=n}else{if(rightTicket.length<4){for(var i=rightTicket.length-1;i>=0;i--){rightTicket[i+1]=rightTicket[i];rightWindow[i+1]=rightWindow[i];rightId[i+1]=rightId[i];rightColor[i+1]=rightColor[i]}rightTicket[0]=leftTicket[3];rightWindow[0]=leftWindow[3];rightId[0]=leftId[3];rightColor[0]=leftColor[3];for(var i=leftTicket.length-2;i>=0;i--){leftTicket[i+1]=leftTicket[i];leftWindow[i+1]=leftWindow[i];leftId[i+1]=leftId[i];leftColor[i+1]=leftColor[i]}leftTicket[0]=e;leftWindow[0]=t;leftId[0]=r;leftColor[0]=n}else{rightTicket.pop();rightWindow.pop();rightId.pop();rightColor.pop();for(var i=rightTicket.length-1;i>=0;i--){rightTicket[i+1]=rightTicket[i];rightWindow[i+1]=rightWindow[i];rightId[i+1]=rightId[i];rightColor[i+1]=rightColor[i]}rightTicket[0]=leftTicket[3];rightWindow[0]=leftWindow[3];rightId[0]=leftId[3];rightColor[0]=leftColor[3];for(var i=leftTicket.length-2;i>=0;i--){leftTicket[i+1]=leftTicket[i];leftWindow[i+1]=leftWindow[i];leftId[i+1]=leftId[i];leftColor[i+1]=leftColor[i]}leftTicket[0]=e;leftWindow[0]=t;leftId[0]=r;leftColor[0]=n}}draw()}function draw(){if(leftTicket.length>0){$leftside_list.empty();$rightside_list.empty();console.log(leftTicket.length);if(leftSide&&rightSide){$leftside_list.append($($addingItem(leftTicket[0],leftWindow[0],leftId[0])).hide().fadeIn("slow"));for(var e=1;e<leftTicket.length;e++){$leftside_list.append($addingItem(leftTicket[e],leftWindow[e],leftId[e]))}for(var e=0;e<rightTicket.length;e++){$rightside_list.append($addingItem(rightTicket[e],rightWindow[e],rightId[e]))}for(var e=0;e<leftTicket.length;e++){$("#"+leftId[e]).css("color","#"+leftColor[e])}for(var e=0;e<rightTicket.length;e++){$("#"+rightId[e]).css("color","#"+rightColor[e])}}else if(rightSide){$rightside_list.append($($addingItem(leftTicket[0],leftWindow[0],leftId[0])).hide().fadeIn("slow"));for(var e=1;e<leftTicket.length;e++){$rightside_list.append($addingItem(leftTicket[e],leftWindow[e],leftId[e]))}for(var e=0;e<leftTicket.length;e++){$("#"+leftId[e]).css("color","#"+leftColor[e])}}sessionStorage.setItem("leftTicket",leftTicket);sessionStorage.setItem("leftWindow",leftWindow);sessionStorage.setItem("leftId",leftId);sessionStorage.setItem("rightTicket",rightTicket);sessionStorage.setItem("rightWindow",rightWindow);sessionStorage.setItem("rightId",rightId)}}function PlaySound(){$("#audio").empty();$("#audio").html("<audio autoplay='autoplay'><source src='javascripts/dash/Contact_Off.m4a'/></audio>");draw()}function _init(e){_msg=e;$("head").empty();$("head").append("<meta charset='utf-8'><meta name='description' content='CQ'><meta name='viewport' content='width=device-width, initial-scale=1'><link rel='stylesheet' href='stylesheets/main.css'>");location.hash="#!dashboard";jQuery("#connectionStatus").text("");document.title="CQ - Dashboard";$("#body").css("min-height","100%");jQuery("#navBar").hide();announcer=document.getElementById("announcer");jQuery("#flashPanel").removeClass("hidden");console.log("-----------------------");jQuery("title").text(e.group);if(e.runningLine){$("#line").text(e.runningLine)}if(e.tokens){jQuery(e.tokens).each(function(t){setTimeout(function(){var n=e.tokens[t];console.log("--------------1");console.log(n.window);console.log(n.ticket);console.log("--------------2");if(n.isTicketReserved==10){if(n.color){runTicket(n.ticket,n.window,n.color,n.tokenId)}else{runTicket(n.ticket,n.window,"",n.tokenId)}}else{if(n.color){console.log(n.ticket+" "+n.window+" "+n.color+" "+n.tokenId);runTicket(n.ticket,n.window,n.color,n.tokenId)}else{runTicket(n.ticket,n.window,"",n.tokenId)}}},200)})}if(e.videoPath){videoPath_=e.videoPath}}function videoPlay(e){$("#ad").empty();$(".wrapper").hide();$("#ad").html("<video width='100%' controls='' autoplay='' name='media'><source src='"+e+"' type='video/mp4'></video>");draw()}function videoStop(){$("#ad").empty();$(".wrapper").show();afterVideo()}function afterVideo(){if(leftTicket.length>0){$leftside_list.empty();$rightside_list.empty();$leftside_list.append($($addingItem(leftTicket[0],leftWindow[0],leftId[0])).hide().fadeIn("slow"));for(var e=1;e<leftTicket.length;e++){$leftside_list.append($addingItem(leftTicket[e],leftWindow[e],leftId[e]))}for(var e=0;e<rightTicket.length;e++){$rightside_list.append($addingItem(rightTicket[e],rightWindow[e],rightId[e]))}for(var e=0;e<leftTicket.length;e++){$("#"+leftId[e]).css("color","#"+leftColor[e])}for(var e=0;e<rightTicket.length;e++){$("#"+rightId[e]).css("color","#"+rightColor[e])}}}function reklamaLeftPlay(e){$("#leftReklama").empty();$("#leftList").hide();leftSide=false;$("#leftReklama").html("<video width='100%' controls='' autoplay='' name='media'><source src='"+e+"' type='video/mp4'></video>");jQuery("body").append(jQuery("<link rel='stylesheet' href='stylesheets/dashRight.css'>"));draw()}function reklamaLeftStop(){console.log("stop1");$("#leftReklama").empty();console.log("stop2");$("#leftList").show();console.log("stop3");leftSide=true;jQuery("body").append(jQuery("<link rel='stylesheet' href='stylesheets/dashLeft.css'>"));afterVideo()}function reklamaRightPlay(e){$("#rightReklama").empty();$("#rightList").hide();rightSide=false;$("#rightReklama").html("<video width='100%' controls='' autoplay='' name='media'><source src='"+e+"' type='video/mp4'></video>")}function reklamaRightStop(){$("#rightReklama").empty();$("#rightList").show();rightSide=true;afterVideo()}function _onMessage(e){var t={};try{t=JSON.parse(e)}catch(n){console.warn("Dashboard got non-JSON message:"+e);return}console.log(t);if(t.videoAction){console.log(t.videoAction);if(t.videoAction=="reklamaLeftPlay"){reklamaLeftPlay(videoPath_)}else if(t.videoAction=="reklamaRightPlay"){reklamaRightPlay(videoPath_)}else if(t.videoAction=="videoPlay"){videoPlay(videoPath_)}else if(t.videoAction=="reklamaLeftStop"){reklamaLeftStop(videoPath_)}else if(t.videoAction=="reklamaRightStop"){reklamaRightStop(videoPath_)}else if(t.videoAction=="videoStop"){videoStop(videoPath_)}else if(t.videoAction=="runningLine"){$("#line").text(t.runningLine)}}console.log("sulta"+t);if(t.ticket&&(t.called||t.recalled)){console.log(window+" "+ticket);unitWindow=t.window;ticket=t.ticket;PlaySound();if(t.isTicketReserved){runTicket(t.ticket,t.window,t.color,t.tokenId)}else{runTicket(t.ticket,t.window,t.color,t.tokenId)}}if(t.videoPath){videoPath_=t.videoPath}}function _onStatus(e){console.log("_onStatus:"+ruStatuses[e]);if(e=="DISCONNECTED"){jQuery("#connectionStatus").text(ruStatuses[e]);jQuery("#connectionStatus").css("color","red")}}var $rightside=$(".rightside"),$leftside=$(".leftside"),$leftside_list=$leftside.children(".list"),$rightside_list=$rightside.children(".list"),$ticketNumber=101,$windowNumber=9,$ticketId=0;var rightTicket=new Array;var rightWindow=new Array;var rightId=new Array;var rightColor=new Array;var leftTicket=new Array;var leftWindow=new Array;var leftId=new Array;var leftColor=new Array;$addingItem=function(e,t,n){return'<li><span id = "'+n+'" class="ticket-number" style="margin-left:-20px;">'+e+'</span><span class="icon icon-arrow-right"></span><span class="window-number">'+t+"</span></li>"};var _kk={};var _ru={};var announcer=null;var dashboard=null;var _msg=null;var unitWindow="";var ticket="";var leftSide=true;var rightSide=true;var videoPath_=null